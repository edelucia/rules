title: Potential CVE-2025-53136 Exploitation via NtQueryInformationToken Race Condition
id: e16ac622-7884-494c-a5b4-6c1f682dcced
status: experimental
description: >-
  Detects potential exploitation of CVE-2025-53136 by identifying a high volume of 'NtQueryInformationToken' calls with the 'TokenAccessInformation' class from a single process that does not hold 'SeDebugPrivilege'.
  This behavior is a strong indicator of an attempt to win a race condition to leak kernel addresses and bypass KASLR.
references:
  - https://www.crowdfense.com/nt-os-kernel-information-disclosure-vulnerability-cve-2025-53136/
author: Emanuele De Lucia
date: 2025-09-16
tags:
  - attack.t1055
  - attack.privilege_escalation
  - attack.t1068
logsource:
  category: api_call # Warning: This rule requires a log source that can monitor API/syscalls and process token privileges.
  product: windows
detection:
  selection:
    ApiCall: 'NtQueryInformationToken'
    Parameters|contains: 'TokenAccessInformation'
  filter:
    Privileges|contains: 'SeDebugPrivilege'
  condition: selection and not filter
  aggregation:
    by: ProcessGuid # Warning: should adapted (e.g., process.entity_id).
    timespan: 1m
    condition: count() > 100
falsepositives:
  - The threshold of 100 calls per minute may need to be adjusted based on your environment's baseline.
  - Legitimate software without SeDebugPrivilege might unexpectedly call this function, but a high volume is highly suspicious.
  - To further reduce false positives, consider adding filters for processes running at 'Low' integrity level or in an 'AppContainer', as these are common contexts for exploit attempts.
level: high
